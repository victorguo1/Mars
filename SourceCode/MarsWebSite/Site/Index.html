
<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Cloud training, .Net Development training">
    <meta name="author" content="">

    <title>From Zero to Hero: Cloud and more</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
    <style>
        h1 {
            font-size: 24px;
            color: #08a3ca;
        }

        img {
            height: 50px;
            width: 50px;
        }

        i {
            font-size: 20px;
            vertical-align: middle;
        }

        .narrow-padding {
            padding-top: 5px;
            padding-left: 1px;
            padding-right: 1px;
            padding-bottom: 5px;
        }
    </style>
</head>
    <body>       
        <div style="margin-left:10px" class="container" ng-app="myApp" ng-controller="customersCtrl">
            <div ng-include="'header.html'"></div>

            <div class="row">
                <div class="col-xs-8">
                    <b>Cloud Series</b>
                </div>
            </div>
            
            <div ng-repeat="course in courses | orderBy : 'name' | lowercase | filter : '!.net'" class="row">
                <div class="col-xs-1" style=" width:50px">
                    <img src="site/img/{{course.key}}.png" alt="{{course.name}}" />
                </div>
                <div class="col-xs-8">
                    <a href="course.html?course={{course.name}}&path={{course.key}}&isEnrolled={{course.isEnrolled}}"> {{course.name}} </a>
                    <i ng-if="course.isEnrolled" class="fa fa-registered"></i>
                </div>
            </div>

            <div class="row">
                <div class="col-xs-8" >
                    <b>.Net Development Series</b>
                </div>
            </div>
            <div ng-repeat="course in courses | orderBy : 'name' | lowercase | filter : '.net'" class="row">
                <div class="col-xs-1" style="width:50px">
                    <img src="site/img/{{course.key}}.png" alt="{{course.name}}" />
                </div>
                <div class="col-xs-8">
                    <a href="course.html?course={{course.name}}&path={{course.key}}&isEnrolled={{course.isEnrolled}}"> {{course.name}} </a>
                    <i ng-if="course.isEnrolled" class="fa fa-registered"></i>
                </div>
            </div>
        </div>
        <script>
            var app = angular.module('myApp', []);
            app.controller('customersCtrl', function ($scope, $http, $q) {
                $http.get("User").then(function (response) {
                    $scope.user = response.data.trim();
                });

                const promiseCourses = $http.get("Courses");
                const promiseEnrollment = $http.get("Enrollment");

                // wait for courses and enrollment promises
                $q.all([promiseCourses, promiseEnrollment]).then(res => {
                    const coursesData = JSON.parse(res[0].data);
                    const enrollmentsData = JSON.parse(res[1].data);
                    const courses = [];

                    // merge the result from courses and enrollment
                    for (let cd of coursesData) {
                        courses.push({
                            key: cd.RowKey,
                            name: cd.PartitionKey,
                            isEnrolled: enrollmentsData.find((o) => o.RowKey === cd.PartitionKey) !== undefined
                        });
                    }

                    $scope.courses = courses;
                });
            });
        </script>
    </body>

</html>
